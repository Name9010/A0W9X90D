<!DOCTYPE html>
<html lang="tr">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>📊 Quotex Binary Signal Hub v9.0 (SSE)</title>
  <style>
    /* (Yukarıdaki CSS kodunu buraya yapıştır) */
  </style>
</head>
<body>

  <div class="header">
    <h1>📊 Quotex Binary Signal Hub v9.0 (SSE)</h1>
    <p>SSE Live — CALL/PUT Signals — OTC Pairs</p>
  </div>

  <div class="status-panel">
    <div class="status-box">
      <div class="status-title">ACCOUNT STATUS</div>
      <div class="status-value connected">CONNECTED ✅</div>
      <div class="liquidity-indicator"></div>
    </div>
    <div class="status-box">
      <div class="status-title">SERVER</div>
      <div class="status-value connected" id="serverValue">QUOTEX-SERVER-07 🟢</div>
      <div class="liquidity-indicator"></div>
    </div>
    <div class="status-box">
      <div class="status-title">TOKEN</div>
      <div class="status-value warning" id="tokenValue">qxtk_8d7a2f... ✅</div>
      <div class="liquidity-indicator"></div>
    </div>
    <div class="status-box">
      <div class="status-title">SSE STATUS</div>
      <div class="status-value connected" id="sseStatus">OPEN 🔗</div>
      <div class="liquidity-indicator"></div>
    </div>
    <div class="status-box">
      <div class="status-title">BALANCE</div>
      <div class="status-value" id="balanceValue">$0.00 💰</div>
      <div class="liquidity-indicator"></div>
    </div>
  </div>

  <div class="main-content">
    <div class="scanner-panel" id="scannerPanel">
      <h3 class="panel-title">🌀 HyperScan Mode — Pair Scanning...</h3>
    </div>

    <div class="signals-panel" id="signalsPanel">
      <h3 class="panel-title signal">🎯 Live Binary Signals</h3>
      <div class="toggle-auto">
        Auto Signals: <span id="autoStatus">ON</span>
        <button id="toggleAuto">Toggle</button>
      </div>
    </div>

    <div class="logs-panel" id="logsPanel">
      <div class="log"><span class="info">[10:32:15] </span>Connecting to Quotex SSE...</div>
    </div>
  </div>

  <button class="admin-button" id="adminButton">🔒 ADMIN PANEL</button>

  <div class="admin-panel" id="adminPanel">
    <div class="admin-form">
      <h3>🔑 Admin Login</h3>
      <input type="password" id="adminPassword" placeholder="Enter Admin Password" />
      <button id="loginButton">Login</button>
    </div>
  </div>

  <div class="send-panel" id="sendPanel">
    <h3>📤 Send Signal (Admin Only)</h3>
    <form id="sendForm" class="send-form">
      <select id="pair" required>
        <option value="">Select Pair</option>
        <option value="EUR/USD">EUR/USD</option>
        <option value="GBP/JPY">GBP/JPY</option>
        <!-- (Diğer pair'leri ekle) -->
      </select>
      <select id="callput" required>
        <option value="">Call or Put</option>
        <option value="CALL">CALL 📈</option>
        <option value="PUT">PUT 📉</option>
      </select>
      <input type="text" id="risk" placeholder="Risk (LOW/MEDIUM/HIGH)" required />
      <input type="text" id="sender" placeholder="Your Name / Device ID" required />
      <button type="submit">Send Signal ➡️</button>
    </form>

    <h3 style="margin-top: 20px; color: #00f7ff;">💰 Update Balance (Admin)</h3>
    <form id="balanceForm" class="send-form">
      <input type="number" id="newBalance" placeholder="New Balance ($)" step="0.01" required />
      <button type="submit">Update Balance</button>
    </form>
  </div>

  <script>
    const scannerPanel = document.getElementById('scannerPanel');
    const signalsPanel = document.getElementById('signalsPanel');
    const logsPanel = document.getElementById('logsPanel');
    const adminButton = document.getElementById('adminButton');
    const adminPanel = document.getElementById('adminPanel');
    const adminPassword = document.getElementById('adminPassword');
    const loginButton = document.getElementById('loginButton');
    const sendPanel = document.getElementById('sendPanel');
    const sendForm = document.getElementById('sendForm');
    const balanceForm = document.getElementById('balanceForm');
    const balanceValue = document.getElementById('balanceValue');
    const serverValue = document.getElementById('serverValue');
    const tokenValue = document.getElementById('tokenValue');
    const sseStatus = document.getElementById('sseStatus');
    const toggleAuto = document.getElementById('toggleAuto');
    const autoStatus = document.getElementById('autoStatus');

    let autoSignalsEnabled = true;

    const ADMIN_PASSWORD = "binary123";

    // SSE ile veri al
    const eventSource = new EventSource('/events');
    eventSource.onmessage = function(event) {
      const data = JSON.parse(event.data);
      if (data.type === "signal") {
        addSignal(data);
        addLog(`Received signal: ${data.pair} ${data.callput} — Risk: ${data.risk} — From: ${data.sender}`, 'info');
      } else if (data.type === "balance") {
        balanceValue.textContent = `$${data.balance.toFixed(2)} 💰`;
        addLog(`Balance updated to: $${data.balance.toFixed(2)}`, 'success');
      }
    };

    eventSource.onerror = function() {
      sseStatus.textContent = "ERROR 🔌";
      sseStatus.className = "status-value disconnected";
      addLog("SSE connection error.", 'error');
    };

    eventSource.onopen = function() {
      sseStatus.textContent = "OPEN 🔗";
      sseStatus.className = "status-value connected";
      addLog("SSE connected to server.", 'success');
    };

    function addLog(message, type = 'info') {
      const log = document.createElement('div');
      log.className = 'log';
      log.innerHTML = `<span class="${type}">[${new Date().toLocaleTimeString()}] </span>${message}`;
      logsPanel.appendChild(log);
      logsPanel.scrollTop = logsPanel.scrollHeight;
    }

    function addScannerItem(pair, flags, status = "SCANNING") {
      const item = document.createElement('div');
      item.className = 'scanner-item';

      const flagDiv = document.createElement('div');
      flagDiv.style.display = 'flex';
      flags.forEach(flagCode => {
        const flag = document.createElement('div');
        flag.className = 'flag';
        const img = document.createElement('img');
        img.src = `https://flagsapi.com/${flagCode.toUpperCase()}/flat/64.png`;
        img.alt = flagCode;
        flag.appendChild(img);
        flagDiv.appendChild(flag);
      });

      const pairName = document.createElement('span');
      pairName.className = 'pair-name';
      pairName.textContent = pair;

      const otcLabel = document.createElement('span');
      otcLabel.className = 'otc';
      otcLabel.textContent = '(OTC)';

      const scanStatus = document.createElement('span');
      scanStatus.className = 'scan-status';
      scanStatus.textContent = status;

      item.appendChild(flagDiv);
      item.appendChild(pairName);
      item.appendChild(otcLabel);
      item.appendChild(scanStatus);

      scannerPanel.prepend(item);

      if (scannerPanel.children.length > 25) {
        scannerPanel.removeChild(scannerPanel.lastChild);
      }
    }

    function addSignal(signal) {
      if (!autoSignalsEnabled) return;

      const item = document.createElement('div');
      item.className = 'signal-item';
      item.innerHTML = `
        <div style="display:flex;align-items:center;">
          <div class="flag"><img src="https://flagsapi.com/${signal.pair.split('/')[0].substring(0,2).toUpperCase()}/flat/64.png" alt="${signal.pair.split('/')[0]}"/></div>
          <div class="flag"><img src="https://flagsapi.com/${signal.pair.split('/')[1].substring(0,2).toUpperCase()}/flat/64.png" alt="${signal.pair.split('/')[1]}"/></div>
        </div>
        <span class="pair-name">${signal.pair}</span>
        <span class="otc">(OTC)</span>
        <span class="callput ${signal.callput.toLowerCase()}">${signal.callput}</span>
        <span class="signal-status">${signal.risk} — From: ${signal.sender}</span>
      `;
      signalsPanel.appendChild(item);

      if (signalsPanel.children.length > 25) {
        signalsPanel.removeChild(signalsPanel.firstChild.nextSibling);
      }
    }

    // Admin paneli
    adminButton.addEventListener('click', () => {
      adminPanel.style.display = 'flex';
    });

    loginButton.addEventListener('click', () => {
      if (adminPassword.value === ADMIN_PASSWORD) {
        adminPanel.style.display = 'none';
        sendPanel.style.display = 'block';
        addLog("Admin panel opened — You can now send signals & update balance", 'success');
      } else {
        addLog("Incorrect password!", 'error');
      }
    });

    // HTTP ile sinyal gönder
    sendForm.addEventListener('submit', function(e) {
      e.preventDefault();

      const pair = document.getElementById('pair').value;
      const callput = document.getElementById('callput').value;
      const risk = document.getElementById('risk').value;
      const sender = document.getElementById('sender').value;

      if (!pair || !callput || !risk || !sender) {
        addLog("All fields are required!", 'error');
        return;
      }

      const signal = {
        type: "signal",
        pair,
        callput,
        risk,
        sender
      };

      fetch('/send', {
        method: 'POST',
        headers: { 'Content-Type': 'application/json' },
        body: JSON.stringify(signal)
      })
      .then(res => res.json())
      .then(data => {
        addLog(`Signal sent: ${pair} ${callput} — Risk: ${risk} — From: ${sender}`, 'sent');
      })
      .catch(err => {
        addLog("Failed to send signal.", 'error');
      });

      sendForm.reset();
    });

    // Balance update
    balanceForm.addEventListener('submit', function(e) {
      e.preventDefault();
      const newBalance = parseFloat(document.getElementById('newBalance').value);
      if (isNaN(newBalance)) {
        addLog("Invalid balance amount!", 'error');
        return;
      }

      const balanceData = {
        type: "balance",
        balance: newBalance
      };

      fetch('/send', {
        method: 'POST',
        headers: { 'Content-Type': 'application/json' },
        body: JSON.stringify(balanceData)
      })
      .then(res => res.json())
      .then(data => {
        addLog(`Balance updated to: $${newBalance.toFixed(2)}`, 'success');
      })
      .catch(err => {
        addLog("Failed to update balance.", 'error');
      });

      balanceForm.reset();
    });

    // Auto sinyalleri aç/kapat
    toggleAuto.addEventListener('click', () => {
      autoSignalsEnabled = !autoSignalsEnabled;
      autoStatus.textContent = autoSignalsEnabled ? "ON" : "OFF";
      autoStatus.style.color = autoSignalsEnabled ? "#00ff88" : "#ff5555";
      addLog(`Auto signals turned ${autoSignalsEnabled ? 'ON' : 'OFF'}`, autoSignalsEnabled ? 'success' : 'warning');
    });

    // Rastgele server ve token üret
    function generateRandomServer() {
      const servers = [
        "QUOTEX-SERVER-01", "QUOTEX-SERVER-02", "QUOTEX-SERVER-03", "QUOTEX-SERVER-04", "QUOTEX-SERVER-05",
        "QUOTEX-SERVER-06", "QUOTEX-SERVER-07", "QUOTEX-SERVER-08", "QUOTEX-SERVER-09", "QUOTEX-SERVER-10",
        "QUOTEX-BACKUP-01", "QUOTEX-HYPER-01", "QUOTEX-OTC-01", "QUOTEX-MAIN-01", "QUOTEX-EDGE-01"
      ];
      return servers[Math.floor(Math.random() * servers.length)];
    }

    function generateRandomToken() {
      const chars = 'ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789';
      let token = 'qxtk_';
      for (let i = 0; i < 8; i++) {
        token += chars.charAt(Math.floor(Math.random() * chars.length));
      }
      return token;
    }

    // Her 10 saniyede bir server ve token güncelle
    setInterval(() => {
      serverValue.textContent = `${generateRandomServer()} 🟢`;
      tokenValue.textContent = `${generateRandomToken()}... ✅`;
    }, 10000);

    // Rastgele pair’leri tarayalım
    const allPairs = [
      { pair: "USD/BRL", flags: ["us", "br"] },
      { pair: "CAD/CHF", flags: ["ca", "ch"] },
      { pair: "EUR/GBP", flags: ["eu", "gb"] },
      { pair: "EUR/NZD", flags: ["eu", "nz"] },
      { pair: "GBP/USD", flags: ["gb", "us"] },
      { pair: "USD/CAD", flags: ["us", "ca"] },
      { pair: "AUD/CAD", flags: ["au", "ca"] },
      { pair: "AUD/JPY", flags: ["au", "jp"] },
      { pair: "EUR/CHF", flags: ["eu", "ch"] },
      { pair: "USD/EGP", flags: ["us", "eg"] },
      { pair: "USD/TRY", flags: ["us", "tr"] },
      { pair: "NZD/CHF", flags: ["nz", "ch"] },
      { pair: "USD/BDT", flags: ["us", "bd"] },
      { pair: "USD/MXN", flags: ["us", "mx"] },
      { pair: "AUD/USD", flags: ["au", "us"] },
      { pair: "USD/PKR", flags: ["us", "pk"] },
      { pair: "USD/IDR", flags: ["us", "id"] },
      { pair: "CHF/JPY", flags: ["ch", "jp"] },
      { pair: "EUR/SGD", flags: ["eu", "sg"] },
      { pair: "GBP/JPY", flags: ["gb", "jp"] },
      { pair: "AUD/CHF", flags: ["au", "ch"] },
      { pair: "USD/ZAR", flags: ["us", "za"] },
      { pair: "GBP/CAD", flags: ["gb", "ca"] },
      { pair: "GBP/CHF", flags: ["gb", "ch"] },
      { pair: "EUR/JPY", flags: ["eu", "jp"] },
      { pair: "NZD/USD", flags: ["nz", "us"] },
      { pair: "AUD/NZD", flags: ["au", "nz"] },
      { pair: "CAD/JPY", flags: ["ca", "jp"] },
      { pair: "GBP/AUD", flags: ["gb", "au"] },
      { pair: "GBP/NZD", flags: ["gb", "nz"] },
      { pair: "USD/PHP", flags: ["us", "ph"] },
      { pair: "USD/EUR", flags: ["us", "eu"] },
      { pair: "EUR/CAD", flags: ["eu", "ca"] },
      { pair: "EUR/AUD", flags: ["eu", "au"] },
      { pair: "NZD/CAD", flags: ["nz", "ca"] },
      { pair: "NZD/JPY", flags: ["nz", "jp"] },
      { pair: "USD/ARS", flags: ["us", "ar"] },
      { pair: "USD/CHF", flags: ["us", "ch"] },
      { pair: "USD/COP", flags: ["us", "co"] },
      { pair: "USD/DZD", flags: ["us", "dz"] },
      { pair: "USD/INR", flags: ["us", "in"] },
      { pair: "USD/JPY", flags: ["us", "jp"] },
      { pair: "USD/NGN", flags: ["us", "ng"] }
    ];

    let currentPairIndex = 0;

    setInterval(() => {
      if (currentPairIndex >= allPairs.length) {
        currentPairIndex = 0;
      }

      const pair = allPairs[currentPairIndex];
      addScannerItem(pair.pair, pair.flags, "SCANNING");

      currentPairIndex++;
    }, 150);
  </script>

</body>
</html>
